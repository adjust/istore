BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a country);
INSERT INTO before values ('de'),('us'),('es'),('de'),('zz');
CREATE TABLE after (a country);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
 a  
----
 de
 us
 es
 de
 zz
(5 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a device_type);
INSERT INTO before values ('bot'),('console'),('ipod'),('ipod'),('unknown');
CREATE TABLE after (a device_type);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
    a    
---------
 bot
 console
 ipod
 ipod
 unknown
(5 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a os_name);
INSERT INTO before values ('android'),('ios'),('windows'),('ios'),('unknown');
CREATE TABLE after (a os_name);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
    a    
---------
 android
 ios
 windows
 ios
 unknown
(5 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a istore);
INSERT INTO before values ('"1"=>"1"'),('"1"=>"2"'),('"1"=>"3"'),('"2"=>"1"'),('"2"=>NULL'),('"2"=>"2"');
CREATE TABLE after (a istore);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
     a     
-----------
 "1"=>"1"
 "1"=>"2"
 "1"=>"3"
 "2"=>"1"
 "2"=>NULL
 "2"=>"2"
(6 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a country_istore);
INSERT INTO before values ('"de"=>"1"'),('"es"=>"2"'),('"de"=>"3"'),('"us"=>"1"'),('"zz"=>"2"'),('"de"=>NULL');
CREATE TABLE after (a country_istore);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
     a      
------------
 "de"=>"1"
 "es"=>"2"
 "de"=>"3"
 "us"=>"1"
 "zz"=>"2"
 "de"=>NULL
(6 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a device_istore);
INSERT INTO before values ('"bot"=>"1"'),('"phone"=>"2"'),('"bot"=>"3"'),('"tablet"=>"1"'),('"server"=>"2"'),('"server"=>NULL');
CREATE TABLE after (a device_istore);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
       a        
----------------
 "bot"=>"1"
 "phone"=>"2"
 "bot"=>"3"
 "tablet"=>"1"
 "server"=>"2"
 "server"=>NULL
(6 rows)

ROLLBACK;
BEGIN;
-- binary_copy should copy data binary from country;
-- ./spec/binary_copy_spec.rb:28;
CREATE EXTENSION istore;
CREATE TABLE before (a os_name_istore);
INSERT INTO before values ('"android"=>"1"'),('"windows"=>"2"'),('"android"=>"3"'),('"ios"=>"1"'),('"unknown"=>"2"'),('"ios"=>NULL');
CREATE TABLE after (a os_name_istore);
COPY before TO '/tmp/tst' WITH (FORMAT binary);
COPY after FROM '/tmp/tst' WITH (FORMAT binary);
SELECT * FROM after;
       a        
----------------
 "android"=>"1"
 "windows"=>"2"
 "android"=>"3"
 "ios"=>"1"
 "unknown"=>"2"
 "ios"=>NULL
(6 rows)

ROLLBACK;
